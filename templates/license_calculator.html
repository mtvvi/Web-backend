<!doctype html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Калькулятор лицензирования</title>
    <link rel="stylesheet" href="/static/styles/license_models.css">
</head>
<body>
    <div class="header">
        <a href="/license-models" style="text-decoration: none; color: black;">
            <div class="doc-icon"></div>
        </a>
    </div>
    

    <main class="container calculator-wrap">
        <h1 class="calculator-title">Моя заявка на расчет стоимости лицензирования</h1>
        
        <div class="form-section">
            <div class="form-row">
                <label>Название компании</label>
                <input type="text" id="company" value="{{ .request.CompanyName }}" class="form-input">
            </div>
            <div class="form-row">
                <label>Количество пользователей</label>
                <input type="number" id="users" value="{{ .request.UserCount }}" class="form-input">
            </div>

            <div class="form-row">
                <label>Общее количество ядер</label>
                <input type="number" id="cores" value="{{ .request.CoreCount }}" class="form-input">
            </div>
            <div class="form-row">
                <label>Период лицензии (лет)</label>
                <input type="number" id="period" value="{{ .request.LicensePeriodYears }}" class="form-input">
            </div>

            <div class="form-row">
                <label>Уровень поддержки</label>
                <select id="support" class="form-input">
                    <option value="basic" {{ if eq .request.SupportLevel "basic" }}selected{{ end }}>Базовый</option>
                    <option value="standard" {{ if eq .request.SupportLevel "standard" }}selected{{ end }}>Стандартный</option>
                    <option value="premium" {{ if eq .request.SupportLevel "premium" }}selected{{ end }}>Премиум</option>
                </select>
            </div>
        </div>

        <!-- Заголовок таблицы -->
        <div class="license-table-header">
            <div class="header-model">Модель лицензирования</div>
            <div class="header-price">Цена за единицу (руб.)</div>
            <div class="header-support">Коэф. поддержки</div>
            <div class="header-discount">Коэф. скидки</div>
            <div class="header-total">Итого (руб.)</div>
        </div>

        <section class="cart-list">
            {{ range $index, $licenseParam := .request.LicenseParameters }}
            {{ $model := index $.models $index }}
            <article class="cart-item">
                <div class="license-model-cell">
                    <img src="http://localhost:9000/img/{{ $model.Icon }}" alt="{{ $model.Name }}" class="license-image">
                    <div class="license-info">
                        <div class="license-name">{{ $model.Name }}</div>
                        <div class="license-desc">{{ $model.Description }}</div>
                    </div>
                </div>
                
                <div class="price-cell">
                    <span class="price-value">{{ printf "%.0f" $model.BasePrice }}</span>
                </div>
                
                <div class="support-cell">
                    <span class="coeff-value">{{ printf "%.2f" $licenseParam.SupportCoeff }}</span>
                </div>
                
                <div class="discount-cell">
                    <span class="coeff-value">{{ printf "%.2f" $licenseParam.AppliedDiscount }}</span>
                </div>
                
                <div class="total-cell">
                    <span class="final-price">{{ printf "%.0f" $licenseParam.CalculatedCost }}</span>
                </div>
            </article>
            {{ end }}
        </section>

        <!-- Итоговые расчеты (упрощенно) -->
        <div class="cost-summary">
            <div class="summary-row total-row">
                <span class="summary-label"><strong>ИТОГОВАЯ СТОИМОСТЬ:</strong></span>
                <span class="summary-value"><strong>{{ printf "%.0f" .request.TotalCost }} руб.</strong></span>
            </div>
        </div>
    </main>

</body>
</html>
